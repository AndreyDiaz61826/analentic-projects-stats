<!DOCTYPE html>
<html>
<head>
    <title>Analentic Projects</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #0a0f1c; color: #00f0ff; font-family: Arial; text-align: center; margin:0; }
        h1 { margin-top: 40px; }
        select { padding:10px; margin:15px; background:#111a2e; color:#00f0ff; border:none; border-radius:8px; }
        .card { background:#111a2e; margin:20px auto; padding:20px; width:400px; border-radius:12px; display:none; }
        #status { font-weight:bold; }
        canvas { max-width: 90%; margin: auto; display:block; }
    </style>
</head>
<body>

<h1>Analentic Projects</h1>
<p>Mini Analytics HQ</p>

<select id="gameSelect" onchange="loadServers()">
    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</option>
    <option value="arizona">Arizona RP</option>
    <option value="black">Black Russia</option>
    <option value="grand">Grand Mobile</option>
</select>

<select id="serverSelect" onchange="loadStats()" style="display:none;">
</select>

<div class="card" id="statsCard">
    <h2 id="serverTitle"></h2>
    <p>–û–Ω–ª–∞–π–Ω: <span id="online">0</span> <span id="status">üü¢</span></p>
    <p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="lastUpdate">--:--:--</span></p>
    <p>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏: <span id="devs"></span></p>
    <p>–°–ø–æ–Ω—Å–æ—Ä—ã: <span id="sponsors"></span></p>
    <p>–î–≤–∏–∂–æ–∫: <span id="engine"></span></p>
    <canvas id="onlineChart"></canvas>
</div>

<script>
// –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ (–ø—Ä–∏–º–µ—Ä, –ø–æ–∑–∂–µ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID API)
const games = {
    arizona: [
        {name:"Phoenix", id:9767606},
        {name:"Tucson", id:9767607}
    ],
    black: [
        {name:"Moscow", id:16588},
        {name:"St.Petersburg", id:16589}
    ],
    grand: [
        {name:"Server 1", id:101},
        {name:"Server 2", id:102}
    ]
};

// –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –æ–Ω–ª–∞–π–Ω
let onlineHistory = [];
let chart;

function loadServers() {
    const game = document.getElementById("gameSelect").value;
    const serverSelect = document.getElementById("serverSelect");
    serverSelect.innerHTML = "";
    document.getElementById("statsCard").style.display = "none";

    if(!game) { serverSelect.style.display="none"; return; }
    serverSelect.style.display="inline-block";

    games[game].forEach(server=>{
        let option=document.createElement("option");
        option.text = server.name;
        option.value = server.id;
        serverSelect.add(option);
    });
}

async function loadStats() {
    const game = document.getElementById("gameSelect").value;
    const serverSelect = document.getElementById("serverSelect");
    const serverId = serverSelect.value;
    if(!serverId) return;

    document.getElementById("statsCard").style.display="block";
    document.getElementById("serverTitle").innerText = serverSelect.options[serverSelect.selectedIndex].text;

    // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    document.getElementById("devs").innerText = "Unknown Devs";
    document.getElementById("sponsors").innerText = "Unknown Sponsors";
    document.getElementById("engine").innerText = "Unknown Engine";

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω
    async function updateOnline() {
        try {
            // –ó–¥–µ—Å—å –≤—Å—Ç–∞–≤–ª—è–µ–º API —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
            const response = await fetch(`https://api.gamemonitoring.ru/servers/${serverId}`);
            const data = await response.json();
            const online = data.numplayers || 0;
            document.getElementById("online").innerText = online;
            document.getElementById("lastUpdate").innerText = new Date().toLocaleTimeString();
            document.getElementById("status").innerText = online>0?"üü¢":"üî¥";

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
            onlineHistory.push(online);
            if(onlineHistory.length>20) onlineHistory.shift();
            chart.data.labels = onlineHistory.map((v,i)=>i+1);
            chart.data.datasets[0].data = onlineHistory;
            chart.update();
        } catch(e) {
            console.log(e);
            document.getElementById("online").innerText = "–û—à–∏–±–∫–∞";
            document.getElementById("status").innerText="üî¥";
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞, –µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π —Ä–∞–∑
    if(!chart) {
        const ctx = document.getElementById('onlineChart').getContext('2d');
        chart = new Chart(ctx, {
            type:'line',
            data: {
                labels: [],
                datasets: [{
                    label:'–û–Ω–ª–∞–π–Ω',
                    data: [],
                    borderColor:'#00f0ff',
                    backgroundColor:'rgba(0,240,255,0.2)',
                    tension:0.3
                }]
            },
            options: { responsive:true, animation:{duration:500} }
        });
    }

    // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    updateOnline();
    setInterval(updateOnline,30000);
}
</script>

</body>
</html>
