<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Analentic Projects</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
    margin: 0;
    font-family: Arial, Helvetica, sans-serif;
    background: #f2f3f5;
    color: #2c2c2c;
}

/* Верхняя панель */
.topbar {
    background: #ffffff;
    border-bottom: 1px solid #dcdcdc;
    padding: 12px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.logo {
    font-size: 20px;
    font-weight: bold;
    color: #c0392b;
}

/* Навигация как на форуме */
.nav {
    background: #ffffff;
    border-bottom: 1px solid #dcdcdc;
    display: flex;
    gap: 20px;
    padding: 10px 20px;
}

.nav button {
    background: none;
    border: none;
    font-size: 15px;
    cursor: pointer;
    padding: 6px 0;
    border-bottom: 2px solid transparent;
}

.nav button.active {
    border-bottom: 2px solid #c0392b;
    font-weight: bold;
}

/* Контент */
.container {
    max-width: 1000px;
    margin: 20px auto;
}

.block {
    background: #ffffff;
    border: 1px solid #dcdcdc;
    border-radius: 4px;
    margin-bottom: 20px;
}

.block-header {
    padding: 12px 15px;
    background: #fafafa;
    border-bottom: 1px solid #dcdcdc;
    font-weight: bold;
}

.block-content {
    padding: 15px;
}

select {
    padding: 8px;
    border: 1px solid #cfcfcf;
    border-radius: 4px;
    font-size: 14px;
}

/* Discord блок */
.discord-footer {
    margin: 40px auto;
    max-width: 1000px;
    background: #5865F2;
    color: white;
    padding: 18px;
    border-radius: 6px;
    text-align: center;
    transition: 0.3s;
}

.discord-footer a {
    color: white;
    text-decoration: none;
    font-weight: bold;
    font-size: 16px;
}

.discord-footer:hover {
    background: #4752c4;
}

.hidden {
    display: none;
}
</style>
</head>

<body>

<div class="topbar">
    <div class="logo">Analentic Projects</div>
</div>

<div class="nav">
    <button id="btnAZ" class="active" onclick="switchTab('az')">Arizona RP</button>
    <button id="btnRD" onclick="switchTab('rd')">Rodina RP</button>
</div>

<div class="container">

    <!-- Arizona -->
    <div id="azSection">

        <div class="block">
            <div class="block-header">Общий онлайн проекта</div>
            <div class="block-content">
                <span id="az_total">Загрузка...</span>
            </div>
        </div>

        <div class="block">
            <div class="block-header">Выбор сервера</div>
            <div class="block-content">
                <select id="az_select" onchange="loadAZ()">
                    <option value="">Выберите сервер</option>
                    <option value="9767606">Arizona RP | Eshkere</option>
                </select>
            </div>
        </div>

        <div class="block hidden" id="az_info">
            <div class="block-header" id="az_name">Сервер</div>
            <div class="block-content">
                Онлайн: <span id="az_online"></span><br>
                Макс: <span id="az_max"></span>
                <canvas id="az_chart"></canvas>
            </div>
        </div>

    </div>

    <!-- Rodina -->
    <div id="rdSection" class="hidden">

        <div class="block">
            <div class="block-header">Общий онлайн проекта</div>
            <div class="block-content">
                <span id="rd_total">Загрузка...</span>
            </div>
        </div>

        <div class="block">
            <div class="block-header">Выбор сервера</div>
            <div class="block-content">
                <select id="rd_select" onchange="loadRD()">
                    <option value="">Выберите сервер</option>
                    <option value="10022967">Rodina RP | Official</option>
                </select>
            </div>
        </div>

        <div class="block hidden" id="rd_info">
            <div class="block-header" id="rd_name">Сервер</div>
            <div class="block-content">
                Онлайн: <span id="rd_online"></span><br>
                Макс: <span id="rd_max"></span>
                <canvas id="rd_chart"></canvas>
            </div>
        </div>

    </div>

</div>

<div class="discord-footer">
    <a href="https://discord.gg/yhzmfQVNx" target="_blank">
        Присоединяйтесь к Discord серверу ✨Dark Straiwels✨
    </a>
</div>

<script>
function switchTab(tab) {
    document.getElementById("azSection").classList.toggle("hidden", tab !== "az");
    document.getElementById("rdSection").classList.toggle("hidden", tab !== "rd");
    document.getElementById("btnAZ").classList.toggle("active", tab === "az");
    document.getElementById("btnRD").classList.toggle("active", tab === "rd");
}

let azHistory=[], rdHistory=[];
let azChart, rdChart;

async function updateTotals(){
    try{
        let az = await fetch("https://api.gamemonitoring.ru/servers/9767606").then(r=>r.json());
        document.getElementById("az_total").innerText = az.numplayers ?? 0;
    }catch{}

    try{
        let rd = await fetch("https://api.gamemonitoring.ru/servers/10022967").then(r=>r.json());
        document.getElementById("rd_total").innerText = rd.numplayers ?? 0;
    }catch{}
}
updateTotals();
setInterval(updateTotals,30000);

async function loadAZ(){
    let sel=document.getElementById("az_select");
    if(!sel.value) return;
    let data=await fetch("https://api.gamemonitoring.ru/servers/"+sel.value).then(r=>r.json());
    document.getElementById("az_info").classList.remove("hidden");
    document.getElementById("az_name").innerText=sel.options[sel.selectedIndex].text;
    document.getElementById("az_online").innerText=data.numplayers;
    document.getElementById("az_max").innerText=data.maxplayers;

    azHistory.push(data.numplayers);
    if(azHistory.length>20) azHistory.shift();

    if(!azChart){
        azChart=new Chart(document.getElementById("az_chart"),{
            type:"line",
            data:{labels:azHistory.map((v,i)=>i+1),
            datasets:[{label:"Онлайн",data:azHistory}]}
        });
    }else{
        azChart.data.labels=azHistory.map((v,i)=>i+1);
        azChart.data.datasets[0].data=azHistory;
        azChart.update();
    }
}

async function loadRD(){
    let sel=document.getElementById("rd_select");
    if(!sel.value) return;
    let data=await fetch("https://api.gamemonitoring.ru/servers/"+sel.value).then(r=>r.json());
    document.getElementById("rd_info").classList.remove("hidden");
    document.getElementById("rd_name").innerText=sel.options[sel.selectedIndex].text;
    document.getElementById("rd_online").innerText=data.numplayers;
    document.getElementById("rd_max").innerText=data.maxplayers;

    rdHistory.push(data.numplayers);
    if(rdHistory.length>20) rdHistory.shift();

    if(!rdChart){
        rdChart=new Chart(document.getElementById("rd_chart"),{
            type:"line",
            data:{labels:rdHistory.map((v,i)=>i+1),
            datasets:[{label:"Онлайн",data:rdHistory}]}
        });
    }else{
        rdChart.data.labels=rdHistory.map((v,i)=>i+1);
        rdChart.data.datasets[0].data=rdHistory;
        rdChart.update();
    }
}
</script>

</body>
</html>
